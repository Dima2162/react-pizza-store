{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\DimaP\\\\Desktop\\\\\\u041F\\u0440\\u043E\\u0435\\u043A\\u0442\\u044B\\\\React_handmade\\\\mypizza\\\\src\\\\pages\\\\Home.jsx\",\n  _s = $RefreshSig$();\nimport React from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport Categories from '../components/Categories';\nimport Sort from '../components/Sort';\nimport PizzaBlock from '../components/PizzaBlock';\nimport Pagination from '../components/Pagination';\nimport { SearchContext } from '../App';\nimport { selectFilter, setCategoryId, setPageCount } from '../redux/slice/filterSlice';\nimport { fetchPizzas, selectPizzaData } from '../redux/slice/pizzaSlice';\nimport Skeleton from '../components/Skeleton';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Home = () => {\n  _s();\n  const dispatch = useDispatch();\n  const {\n    items,\n    status\n  } = useSelector(selectPizzaData);\n  const {\n    categoryId,\n    sort,\n    pageCount,\n    sear\n  } = useSelector(selectFilter);\n  const {\n    searchValue\n  } = React.useContext(SearchContext);\n  const onClickCategory = id => {\n    dispatch(setCategoryId(id));\n  };\n  const onChangePage = page => {\n    dispatch(setPageCount(page));\n  };\n  const getPizzas = async () => {\n    const sortBy = sort.sortPropety.replace('-', '');\n    const order = sort.sortPropety.includes('-') ? 'asc' : 'desc';\n    const category = categoryId > 0 ? `&category_like=${categoryId}` : '';\n    const search = searchValue ? `&title_like=${searchValue}` : '';\n    dispatch(fetchPizzas({\n      sortBy,\n      order,\n      category,\n      search,\n      pageCount\n    }));\n  };\n  React.useEffect(() => {\n    getPizzas();\n  }, [categoryId, sort.sortPropety, searchValue, pageCount]);\n\n  // React.useEffect(() => {\n  // \tif (window.location.search) {\n  // \t\tconst params = qs.parse(window.location.search.substring(1));\n  // \t\tconst sort = sortList.find((obj) => obj.sortPropety === params.sortPropety);\n  // \t\tdispatch(\n  // \t\t\tsetFilters({\n  // \t\t\t\t...params,\n  // \t\t\t\tsort,\n  // \t\t\t}),\n  // \t\t);\n  // \t\tisSearch.current = true;\n  // \t}\n  // }, []);\n\n  // React.useEffect(() => {\n  // \twindow.scrollTo(0, 0);\n  // \tif(isSearch.current){\n  // \t\tfetchPizzas()\n  // \t}\n  // \tisSearch.current = false;\n\n  // }, [categoryId, sort.sortPropety, searchValue, pageCount]);\n\n  // React.useEffect(() => {\n  // if(isMounted.current){\n  // \tconst queryString = qs.stringify({\n  // \t\tsortPropety: sort.sortPropety,\n  // \t\tcategoryId,\n  // \t\tpageCount,\n  // \t});\n  // \tnavigate(`?${queryString}`);\n  // }\n  // isMounted.current = true\n  // }, [categoryId, sort.sortPropety, pageCount]);\n  const pizzas = items.map(obj => /*#__PURE__*/_jsxDEV(PizzaBlock, {\n    ...obj\n  }, obj.id, false, {\n    fileName: _jsxFileName,\n    lineNumber: 80,\n    columnNumber: 36\n  }, this));\n  const skeletons = [...new Array(6)].map((_, index) => /*#__PURE__*/_jsxDEV(Skeleton, {}, index, false, {\n    fileName: _jsxFileName,\n    lineNumber: 81,\n    columnNumber: 56\n  }, this));\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"content__top\",\n      children: [/*#__PURE__*/_jsxDEV(Categories, {\n        value: categoryId,\n        onClickCategory: onClickCategory\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(Sort, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"content__title\",\n      children: \"\\u0412\\u0441\\u0435 \\u043F\\u0438\\u0446\\u0446\\u044B\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 4\n    }, this), status === 'error' ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"content__error-info\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: [\"\\u041F\\u0440\\u043E\\u0438\\u0437\\u043E\\u0448\\u043B\\u0430 \\u043E\\u0448\\u0438\\u0431\\u043A\\u0430 \", /*#__PURE__*/_jsxDEV(\"icon\", {\n          children: \"\\uD83D\\uDE15\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 24\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\u041A \\u0441\\u043E\\u0436\\u0430\\u043B\\u0435\\u043D\\u0438\\u044E,\\u043D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u043F\\u043E\\u043B\\u0443\\u0447\\u0438\\u0442\\u044C \\u043F\\u0438\\u0442\\u0441\\u044B.\\u041F\\u043E\\u043F\\u0440\\u043E\\u0431\\u0443\\u0439\\u0442\\u0435 \\u043F\\u043E\\u0432\\u0442\\u043E\\u0440\\u0438\\u0442\\u044C \\u043F\\u043E\\u043F\\u044B\\u0442\\u043A\\u0443 \\u043F\\u043E\\u0437\\u0436\\u0435.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 6\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 5\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"content__items\",\n      children: status === 'loading' ? skeletons : pizzas\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(Pagination, {\n      pageCount: pageCount,\n      onChangePage: onChangePage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 83,\n    columnNumber: 3\n  }, this);\n};\n_s(Home, \"JfTasFVp8mYeysqLkepwnUjyK1o=\", false, function () {\n  return [useDispatch, useSelector, useSelector];\n});\n_c = Home;\nexport default Home;\n\n// import { useNavigate } from 'react-router-dom';\n// import qs from 'qs';\n\n// const navigate = useNavigate();\n// const isSearch = React.useRef(false);\n// const isMounted = React.useRef(false);\n\n// await axios\n// \t.get(\n// \t\t`http://localhost:3002/pizzas?_page=${pageCount}&_limit=4${category}&_sort=${sortBy}&_order=${order}${search}`,\n// \t)\n// \t.then((res) => {\n// \t\tsetItems(res.data);\n// \t});\n\n// {items.map((obj) => (\n// \t<PizzaBlock key={obj.id} {...obj} />\n// ))}\nvar _c;\n$RefreshReg$(_c, \"Home\");","map":{"version":3,"names":["React","useDispatch","useSelector","Categories","Sort","PizzaBlock","Pagination","SearchContext","selectFilter","setCategoryId","setPageCount","fetchPizzas","selectPizzaData","Skeleton","Home","dispatch","items","status","categoryId","sort","pageCount","sear","searchValue","useContext","onClickCategory","id","onChangePage","page","getPizzas","sortBy","sortPropety","replace","order","includes","category","search","useEffect","pizzas","map","obj","skeletons","Array","_","index"],"sources":["C:/Users/DimaP/Desktop/Проекты/React_handmade/mypizza/src/pages/Home.jsx"],"sourcesContent":["import React from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\n\r\nimport Categories from '../components/Categories';\r\nimport Sort from '../components/Sort';\r\nimport PizzaBlock from '../components/PizzaBlock';\r\n\r\nimport Pagination from '../components/Pagination';\r\nimport { SearchContext } from '../App';\r\nimport { selectFilter, setCategoryId, setPageCount } from '../redux/slice/filterSlice';\r\nimport { fetchPizzas, selectPizzaData } from '../redux/slice/pizzaSlice';\r\nimport Skeleton from '../components/Skeleton';\r\n\r\nconst Home = () => {\r\n\tconst dispatch = useDispatch();\r\n\tconst { items, status } = useSelector(selectPizzaData);\r\n\tconst { categoryId, sort, pageCount, sear } = useSelector(selectFilter);\r\n\tconst { searchValue } = React.useContext(SearchContext);\r\n\tconst onClickCategory = (id) => {\r\n\t\tdispatch(setCategoryId(id));\r\n\t};\r\n\tconst onChangePage = (page) => {\r\n\t\tdispatch(setPageCount(page));\r\n\t};\r\n\tconst getPizzas = async () => {\r\n\t\tconst sortBy = sort.sortPropety.replace('-', '');\r\n\t\tconst order = sort.sortPropety.includes('-') ? 'asc' : 'desc';\r\n\t\tconst category = categoryId > 0 ? `&category_like=${categoryId}` : '';\r\n\t\tconst search = searchValue ? `&title_like=${searchValue}` : '';\r\n\r\n\t\tdispatch(\r\n\t\t\tfetchPizzas({\r\n\t\t\t\tsortBy,\r\n\t\t\t\torder,\r\n\t\t\t\tcategory,\r\n\t\t\t\tsearch,\r\n\t\t\t\tpageCount,\r\n\t\t\t}),\r\n\t\t);\r\n\t};\r\n\r\n\tReact.useEffect(() => {\r\n\t\tgetPizzas();\r\n\t}, [categoryId, sort.sortPropety, searchValue, pageCount]);\r\n\r\n\t// React.useEffect(() => {\r\n\t// \tif (window.location.search) {\r\n\t// \t\tconst params = qs.parse(window.location.search.substring(1));\r\n\t// \t\tconst sort = sortList.find((obj) => obj.sortPropety === params.sortPropety);\r\n\t// \t\tdispatch(\r\n\t// \t\t\tsetFilters({\r\n\t// \t\t\t\t...params,\r\n\t// \t\t\t\tsort,\r\n\t// \t\t\t}),\r\n\t// \t\t);\r\n\t// \t\tisSearch.current = true;\r\n\t// \t}\r\n\t// }, []);\r\n\r\n\t// React.useEffect(() => {\r\n\t// \twindow.scrollTo(0, 0);\r\n\t// \tif(isSearch.current){\r\n\t// \t\tfetchPizzas()\r\n\t// \t}\r\n\t// \tisSearch.current = false;\r\n\r\n\t// }, [categoryId, sort.sortPropety, searchValue, pageCount]);\r\n\r\n\t// React.useEffect(() => {\r\n\t// if(isMounted.current){\r\n\t// \tconst queryString = qs.stringify({\r\n\t// \t\tsortPropety: sort.sortPropety,\r\n\t// \t\tcategoryId,\r\n\t// \t\tpageCount,\r\n\t// \t});\r\n\t// \tnavigate(`?${queryString}`);\r\n\t// }\r\n\t// isMounted.current = true\r\n\t// }, [categoryId, sort.sortPropety, pageCount]);\r\n\tconst pizzas = items.map((obj) => <PizzaBlock key={obj.id} {...obj} />);\r\n\tconst skeletons = [...new Array(6)].map((_, index) => <Skeleton key={index} />);\r\n\treturn (\r\n\t\t<div className=\"container\">\r\n\t\t\t<div className=\"content__top\">\r\n\t\t\t\t<Categories value={categoryId} onClickCategory={onClickCategory} />\r\n\t\t\t\t<Sort />\r\n\t\t\t</div>\r\n\t\t\t<h2 className=\"content__title\">Все пиццы</h2>\r\n\t\t\t{status === 'error' ? (\r\n\t\t\t\t<div className='content__error-info'>\r\n\t\t\t\t\t<h2>\r\n\t\t\t\t\t\tПроизошла ошибка <icon>😕</icon>\r\n\t\t\t\t\t</h2>\r\n\t\t\t\t\t<p>К сожалению,не удалось получить питсы.Попробуйте повторить попытку позже.</p>\r\n\t\t\t\t</div>\r\n\t\t\t) : (\r\n\t\t\t\t<div className=\"content__items\">{status === 'loading' ? skeletons : pizzas}</div>\r\n\t\t\t)}\r\n\t\t\t<Pagination pageCount={pageCount} onChangePage={onChangePage} />\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Home;\r\n\r\n// import { useNavigate } from 'react-router-dom';\r\n// import qs from 'qs';\r\n\r\n// const navigate = useNavigate();\r\n// const isSearch = React.useRef(false);\r\n// const isMounted = React.useRef(false);\r\n\r\n// await axios\r\n// \t.get(\r\n// \t\t`http://localhost:3002/pizzas?_page=${pageCount}&_limit=4${category}&_sort=${sortBy}&_order=${order}${search}`,\r\n// \t)\r\n// \t.then((res) => {\r\n// \t\tsetItems(res.data);\r\n// \t});\r\n\r\n// {items.map((obj) => (\r\n// \t<PizzaBlock key={obj.id} {...obj} />\r\n// ))}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}