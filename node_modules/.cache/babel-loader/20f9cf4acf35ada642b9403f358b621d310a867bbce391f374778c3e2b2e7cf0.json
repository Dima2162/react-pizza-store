{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\DimaP\\\\Desktop\\\\\\u041F\\u0440\\u043E\\u0435\\u043A\\u0442\\u044B\\\\React_handmade\\\\mypizza\\\\src\\\\pages\\\\Home.jsx\",\n  _s = $RefreshSig$();\nimport React from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport Categories from '../components/Categories';\nimport Sort from '../components/Sort';\nimport PizzaBlock from '../components/PizzaBlock';\nimport Pagination from '../components/Pagination';\nimport { SearchContext } from '../App';\nimport { setCategoryId, setPageCount } from '../redux/slice/filterSlice';\nimport { fetchPizzas } from '../redux/slice/pizzaSlice';\nimport Skeleton from '../components/Skeleton';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Home = () => {\n  _s();\n  const dispatch = useDispatch();\n  const {\n    items,\n    status\n  } = useSelector(state => state.pizzaSlice);\n  const {\n    categoryId,\n    sort,\n    pageCount\n  } = useSelector(state => state.filterSlice);\n  const {\n    searchValue\n  } = React.useContext(SearchContext);\n  // const [items, setItems] = React.useState([]);\n\n  const onClickCategory = id => {\n    dispatch(setCategoryId(id));\n  };\n  const onChangePage = page => {\n    dispatch(setPageCount(page));\n  };\n  const getPizzas = async () => {\n    const sortBy = sort.sortPropety.replace('-', '');\n    const order = sort.sortPropety.includes('-') ? 'asc' : 'desc';\n    const category = categoryId > 0 ? `&category_like=${categoryId}` : '';\n    const search = searchValue ? `&title_like=${searchValue}` : '';\n    dispatch(fetchPizzas({\n      sortBy,\n      order,\n      category,\n      search,\n      pageCount\n    }));\n  };\n  React.useEffect(() => {\n    getPizzas();\n  }, [categoryId, sort.sortPropety, searchValue, pageCount]);\n\n  // React.useEffect(() => {\n  // \tif (window.location.search) {\n  // \t\tconst params = qs.parse(window.location.search.substring(1));\n  // \t\tconst sort = sortList.find((obj) => obj.sortPropety === params.sortPropety);\n  // \t\tdispatch(\n  // \t\t\tsetFilters({\n  // \t\t\t\t...params,\n  // \t\t\t\tsort,\n  // \t\t\t}),\n  // \t\t);\n  // \t\tisSearch.current = true;\n  // \t}\n  // }, []);\n\n  // React.useEffect(() => {\n  // \twindow.scrollTo(0, 0);\n  // \tif(isSearch.current){\n  // \t\tfetchPizzas()\n  // \t}\n  // \tisSearch.current = false;\n\n  // }, [categoryId, sort.sortPropety, searchValue, pageCount]);\n\n  // React.useEffect(() => {\n  // if(isMounted.current){\n  // \tconst queryString = qs.stringify({\n  // \t\tsortPropety: sort.sortPropety,\n  // \t\tcategoryId,\n  // \t\tpageCount,\n  // \t});\n  // \tnavigate(`?${queryString}`);\n  // }\n  // isMounted.current = true\n  // }, [categoryId, sort.sortPropety, pageCount]);\n  const pizzas = items.map(obj => /*#__PURE__*/_jsxDEV(PizzaBlock, {\n    ...obj\n  }, obj.id, false, {\n    fileName: _jsxFileName,\n    lineNumber: 83,\n    columnNumber: 36\n  }, this));\n  const skeletons = [...new Array(6)].map((_, index) => /*#__PURE__*/_jsxDEV(Skeleton, {}, index, false, {\n    fileName: _jsxFileName,\n    lineNumber: 84,\n    columnNumber: 56\n  }, this));\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"content__top\",\n      children: [/*#__PURE__*/_jsxDEV(Categories, {\n        value: categoryId,\n        onClickCategory: onClickCategory\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(Sort, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"content__title\",\n      children: \"\\u0412\\u0441\\u0435 \\u043F\\u0438\\u0446\\u0446\\u044B\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 4\n    }, this), status === 'error' ? /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: [\"\\u041A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0430 \\u043F\\u0443\\u0441\\u0442\\u0430\\u044F \", /*#__PURE__*/_jsxDEV(\"icon\", {\n          children: \"\\uD83D\\uDE15\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"\\u0412\\u0435\\u0440\\u043E\\u044F\\u0442\\u043D\\u0435\\u0439 \\u0432\\u0441\\u0435\\u0433\\u043E, \\u0432\\u044B \\u043D\\u0435 \\u0437\\u0430\\u043A\\u0430\\u0437\\u044B\\u0432\\u0430\\u043B\\u0438 \\u0435\\u0449\\u0451 \\u043F\\u0438\\u0446\\u0446\\u0443.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 6\n        }, this), \"\\u0414\\u043B\\u044F \\u0442\\u043E\\u0433\\u043E, \\u0447\\u0442\\u043E\\u0431\\u044B \\u0437\\u0430\\u043A\\u0430\\u0437\\u0430\\u0442\\u044C \\u043F\\u0438\\u0446\\u0446\\u0443, \\u043F\\u0435\\u0440\\u0435\\u0439\\u0434\\u0438 \\u043D\\u0430 \\u0433\\u043B\\u0430\\u0432\\u043D\\u0443\\u044E \\u0441\\u0442\\u0440\\u0430\\u043D\\u0438\\u0446\\u0443.\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 26\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"content__items\",\n      children: status === 'loading' ? skeletons : pizzas\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(Pagination, {\n      pageCount: pageCount,\n      onChangePage: onChangePage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 86,\n    columnNumber: 3\n  }, this);\n};\n_s(Home, \"JAqIaL0cvanQS7UWkLm0sRfAuQg=\", false, function () {\n  return [useDispatch, useSelector, useSelector];\n});\n_c = Home;\nexport default Home;\n\n// import { useNavigate } from 'react-router-dom';\n// import qs from 'qs';\n\n// const navigate = useNavigate();\n// const isSearch = React.useRef(false);\n// const isMounted = React.useRef(false);\n\n// await axios\n// \t.get(\n// \t\t`http://localhost:3002/pizzas?_page=${pageCount}&_limit=4${category}&_sort=${sortBy}&_order=${order}${search}`,\n// \t)\n// \t.then((res) => {\n// \t\tsetItems(res.data);\n// \t});\n\n// {items.map((obj) => (\n// \t<PizzaBlock key={obj.id} {...obj} />\n// ))}\nvar _c;\n$RefreshReg$(_c, \"Home\");","map":{"version":3,"names":["React","useDispatch","useSelector","Categories","Sort","PizzaBlock","Pagination","SearchContext","setCategoryId","setPageCount","fetchPizzas","Skeleton","Home","dispatch","items","status","state","pizzaSlice","categoryId","sort","pageCount","filterSlice","searchValue","useContext","onClickCategory","id","onChangePage","page","getPizzas","sortBy","sortPropety","replace","order","includes","category","search","useEffect","pizzas","map","obj","skeletons","Array","_","index"],"sources":["C:/Users/DimaP/Desktop/Проекты/React_handmade/mypizza/src/pages/Home.jsx"],"sourcesContent":["import React from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\n\r\nimport Categories from '../components/Categories';\r\nimport Sort from '../components/Sort';\r\nimport PizzaBlock from '../components/PizzaBlock';\r\n\r\nimport Pagination from '../components/Pagination';\r\nimport { SearchContext } from '../App';\r\nimport { setCategoryId, setPageCount } from '../redux/slice/filterSlice';\r\nimport { fetchPizzas } from '../redux/slice/pizzaSlice';\r\nimport Skeleton from '../components/Skeleton';\r\n\r\nconst Home = () => {\r\n\tconst dispatch = useDispatch();\r\n\r\n\tconst { items, status } = useSelector((state) => state.pizzaSlice);\r\n\tconst { categoryId, sort, pageCount } = useSelector((state) => state.filterSlice);\r\n\tconst { searchValue } = React.useContext(SearchContext);\r\n\t// const [items, setItems] = React.useState([]);\r\n\r\n\tconst onClickCategory = (id) => {\r\n\t\tdispatch(setCategoryId(id));\r\n\t};\r\n\tconst onChangePage = (page) => {\r\n\t\tdispatch(setPageCount(page));\r\n\t};\r\n\tconst getPizzas = async () => {\r\n\t\tconst sortBy = sort.sortPropety.replace('-', '');\r\n\t\tconst order = sort.sortPropety.includes('-') ? 'asc' : 'desc';\r\n\t\tconst category = categoryId > 0 ? `&category_like=${categoryId}` : '';\r\n\t\tconst search = searchValue ? `&title_like=${searchValue}` : '';\r\n\r\n\t\tdispatch(\r\n\t\t\tfetchPizzas({\r\n\t\t\t\tsortBy,\r\n\t\t\t\torder,\r\n\t\t\t\tcategory,\r\n\t\t\t\tsearch,\r\n\t\t\t\tpageCount,\r\n\t\t\t}),\r\n\t\t);\r\n\t};\r\n\r\n\tReact.useEffect(() => {\r\n\t\tgetPizzas();\r\n\t}, [categoryId, sort.sortPropety, searchValue, pageCount]);\r\n\r\n\t// React.useEffect(() => {\r\n\t// \tif (window.location.search) {\r\n\t// \t\tconst params = qs.parse(window.location.search.substring(1));\r\n\t// \t\tconst sort = sortList.find((obj) => obj.sortPropety === params.sortPropety);\r\n\t// \t\tdispatch(\r\n\t// \t\t\tsetFilters({\r\n\t// \t\t\t\t...params,\r\n\t// \t\t\t\tsort,\r\n\t// \t\t\t}),\r\n\t// \t\t);\r\n\t// \t\tisSearch.current = true;\r\n\t// \t}\r\n\t// }, []);\r\n\r\n\t// React.useEffect(() => {\r\n\t// \twindow.scrollTo(0, 0);\r\n\t// \tif(isSearch.current){\r\n\t// \t\tfetchPizzas()\r\n\t// \t}\r\n\t// \tisSearch.current = false;\r\n\r\n\t// }, [categoryId, sort.sortPropety, searchValue, pageCount]);\r\n\r\n\t// React.useEffect(() => {\r\n\t// if(isMounted.current){\r\n\t// \tconst queryString = qs.stringify({\r\n\t// \t\tsortPropety: sort.sortPropety,\r\n\t// \t\tcategoryId,\r\n\t// \t\tpageCount,\r\n\t// \t});\r\n\t// \tnavigate(`?${queryString}`);\r\n\t// }\r\n\t// isMounted.current = true\r\n\t// }, [categoryId, sort.sortPropety, pageCount]);\r\n\tconst pizzas = items.map((obj) => <PizzaBlock key={obj.id} {...obj} />);\r\n\tconst skeletons = [...new Array(6)].map((_, index) => <Skeleton key={index} />);\r\n\treturn (\r\n\t\t<div className=\"container\">\r\n\t\t\t<div className=\"content__top\">\r\n\t\t\t\t<Categories value={categoryId} onClickCategory={onClickCategory} />\r\n\t\t\t\t<Sort />\r\n\t\t\t</div>\r\n\t\t\t<h2 className=\"content__title\">Все пиццы</h2>\r\n\t\t\t{\r\n\t\t\t\tstatus === 'error' ? <div>\r\n\t\t\t\t\t<h2>\r\n\t\t\t\t\tКорзина пустая <icon>😕</icon>\r\n\t\t\t\t</h2>\r\n\t\t\t\t<p>\r\n\t\t\t\t\tВероятней всего, вы не заказывали ещё пиццу.\r\n\t\t\t\t\t<br />\r\n\t\t\t\t\tДля того, чтобы заказать пиццу, перейди на главную страницу.\r\n\t\t\t\t</p>\r\n\t\t\t\t</div> :\r\n\t\t\t<div className=\"content__items\">{status === 'loading' ? skeletons : pizzas}</div>\r\n\t\t\t}\r\n\t\t\t<Pagination pageCount={pageCount} onChangePage={onChangePage} />\r\n\t\t</div> \r\n\t);\r\n};\r\n\r\nexport default Home;\r\n\r\n// import { useNavigate } from 'react-router-dom';\r\n// import qs from 'qs';\r\n\r\n// const navigate = useNavigate();\r\n// const isSearch = React.useRef(false);\r\n// const isMounted = React.useRef(false);\r\n\r\n// await axios\r\n// \t.get(\r\n// \t\t`http://localhost:3002/pizzas?_page=${pageCount}&_limit=4${category}&_sort=${sortBy}&_order=${order}${search}`,\r\n// \t)\r\n// \t.then((res) => {\r\n// \t\tsetItems(res.data);\r\n// \t});\r\n\r\n// {items.map((obj) => (\r\n// \t<PizzaBlock key={obj.id} {...obj} />\r\n// ))}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}