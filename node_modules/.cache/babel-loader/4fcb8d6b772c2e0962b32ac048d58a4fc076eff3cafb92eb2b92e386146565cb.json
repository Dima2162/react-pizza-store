{"ast":null,"code":"import _toConsumableArray from\"C:/Users/DimaP/Desktop/\\u041F\\u0440\\u043E\\u0435\\u043A\\u0442\\u044B/React_handmade/mypizza/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"C:/Users/DimaP/Desktop/\\u041F\\u0440\\u043E\\u0435\\u043A\\u0442\\u044B/React_handmade/mypizza/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"C:/Users/DimaP/Desktop/\\u041F\\u0440\\u043E\\u0435\\u043A\\u0442\\u044B/React_handmade/mypizza/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/DimaP/Desktop/\\u041F\\u0440\\u043E\\u0435\\u043A\\u0442\\u044B/React_handmade/mypizza/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import React from'react';import{useSelector}from'react-redux';import Categories from'../components/Categories';import Sort from'../components/Sort';import PizzaBlock from'../components/PizzaBlock';import Pagination from'../components/Pagination';import{selectFilter,setCategoryId,setPageCount}from'../redux/slice/filterSlice';import{fetchPizzas,selectPizzaData}from'../redux/slice/pizzaSlice';import Skeleton from'../components/Skeleton';import{useAppDispatch}from'../redux/store';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Home=function Home(){var dispatch=useAppDispatch();var _useSelector=useSelector(selectPizzaData),items=_useSelector.items,status=_useSelector.status;var _useSelector2=useSelector(selectFilter),categoryId=_useSelector2.categoryId,sort=_useSelector2.sort,pageCount=_useSelector2.pageCount,searchValue=_useSelector2.searchValue;import('../utils/math').then(function(math){console.log(math.add(16,26));});var onClickCategory=React.useCallback(function(id){dispatch(setCategoryId(id));},[]);var onChangePage=function onChangePage(page){dispatch(setPageCount(page));};var getPizzas=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var sortBy,order,category,search;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:sortBy=sort.sortPropety.replace('-','');order=sort.sortPropety.includes('-')?'asc':'desc';category=categoryId>0?\"&category_like=\".concat(categoryId):'';search=searchValue?\"&title_like=\".concat(searchValue):'';dispatch(fetchPizzas({sortBy:sortBy,order:order,category:category,search:search,pageCount:String(pageCount)}));case 5:case\"end\":return _context.stop();}},_callee);}));return function getPizzas(){return _ref.apply(this,arguments);};}();React.useEffect(function(){getPizzas();},[categoryId,sort.sortPropety,searchValue,pageCount]);// React.useEffect(() => {\n// \tif (window.location.search) {\n// \t\tconst params = qs.parse(window.location.search.substring(1));\n// \t\tconst sort = sortList.find((obj) => obj.sortPropety === params.sortPropety);\n// \t\tdispatch(\n// \t\t\tsetFilters({\n// \t\t\t\t...params,\n// \t\t\t\tsort,\n// \t\t\t}),\n// \t\t);\n// \t\tisSearch.current = true;\n// \t}\n// }, []);\n// React.useEffect(() => {\n// \twindow.scrollTo(0, 0);\n// \tif(isSearch.current){\n// \t\tfetchPizzas()\n// \t}\n// \tisSearch.current = false;\n// }, [categoryId, sort.sortPropety, searchValue, pageCount]);\n// React.useEffect(() => {\n// if(isMounted.current){\n// \tconst queryString = qs.stringify({\n// \t\tsortPropety: sort.sortPropety,\n// \t\tcategoryId,\n// \t\tpageCount,\n// \t});\n// \tnavigate(`?${queryString}`);\n// }\n// isMounted.current = true\n// }, [categoryId, sort.sortPropety, pageCount]);\nvar pizzas=items.map(function(obj){return/*#__PURE__*/_jsx(PizzaBlock,_objectSpread({},obj),obj.id);});var skeletons=_toConsumableArray(new Array(6)).map(function(_,index){return/*#__PURE__*/_jsx(Skeleton,{},index);});return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"content__top\",children:[/*#__PURE__*/_jsx(Categories,{value:categoryId,onClickCategory:onClickCategory}),/*#__PURE__*/_jsx(Sort,{value:sort})]}),/*#__PURE__*/_jsx(\"h2\",{className:\"content__title\",children:\"\\u0412\\u0441\\u0435 \\u043F\\u0438\\u0446\\u0446\\u044B\"}),status==='error'?/*#__PURE__*/_jsxs(\"div\",{className:\"content__error-info\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"\\u041F\\u0440\\u043E\\u0438\\u0437\\u043E\\u0448\\u043B\\u0430 \\u043E\\u0448\\u0438\\u0431\\u043A\\u0430 \",/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDE15\"})]}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u041A \\u0441\\u043E\\u0436\\u0430\\u043B\\u0435\\u043D\\u0438\\u044E,\\u043D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u043F\\u043E\\u043B\\u0443\\u0447\\u0438\\u0442\\u044C \\u043F\\u0438\\u0442\\u0441\\u044B.\\u041F\\u043E\\u043F\\u0440\\u043E\\u0431\\u0443\\u0439\\u0442\\u0435 \\u043F\\u043E\\u0432\\u0442\\u043E\\u0440\\u0438\\u0442\\u044C \\u043F\\u043E\\u043F\\u044B\\u0442\\u043A\\u0443 \\u043F\\u043E\\u0437\\u0436\\u0435.\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"content__items\",children:status==='loading'?skeletons:pizzas}),/*#__PURE__*/_jsx(Pagination,{pageCount:pageCount,onChangePage:onChangePage})]});};export default Home;// import { useNavigate } from 'react-router-dom';\n// import qs from 'qs';\n// const navigate = useNavigate();\n// const isSearch = React.useRef(false);\n// const isMounted = React.useRef(false);\n// await axios\n// \t.get(\n// \t\t`http://localhost:3002/pizzas?_page=${pageCount}&_limit=4${category}&_sort=${sortBy}&_order=${order}${search}`,\n// \t)\n// \t.then((res) => {\n// \t\tsetItems(res.data);\n// \t});\n// {items.map((obj) => (\n// \t<PizzaBlock key={obj.id} {...obj} />\n// ))}","map":{"version":3,"names":["React","useSelector","Categories","Sort","PizzaBlock","Pagination","selectFilter","setCategoryId","setPageCount","fetchPizzas","selectPizzaData","Skeleton","useAppDispatch","Home","dispatch","items","status","categoryId","sort","pageCount","searchValue","then","math","console","log","add","onClickCategory","useCallback","id","onChangePage","page","getPizzas","sortBy","sortPropety","replace","order","includes","category","search","String","useEffect","pizzas","map","obj","skeletons","Array","_","index"],"sources":["C:/Users/DimaP/Desktop/–ü—Ä–æ–µ–∫—Ç—ã/React_handmade/mypizza/src/pages/Home.tsx"],"sourcesContent":["import React from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\n\r\nimport Categories from '../components/Categories';\r\nimport Sort from '../components/Sort';\r\nimport PizzaBlock from '../components/PizzaBlock';\r\n\r\nimport Pagination from '../components/Pagination';\r\nimport { selectFilter, setCategoryId, setPageCount } from '../redux/slice/filterSlice';\r\nimport { fetchPizzas, selectPizzaData } from '../redux/slice/pizzaSlice';\r\nimport Skeleton from '../components/Skeleton';\r\nimport { useAppDispatch } from '../redux/store';\r\n\r\nimport { add } from '../utils/math';\r\n\r\nconst Home:React.FC = () => {\r\n\tconst dispatch = useAppDispatch();\r\n\tconst { items, status } = useSelector(selectPizzaData);\r\n\tconst { categoryId, sort, pageCount, searchValue } = useSelector(selectFilter);\r\n\timport('../utils/math').then(math =>{\r\n\t\tconsole.log(math.add(16,26));\r\n\t})\r\n\tconst onClickCategory = React.useCallback((id:number) => {\r\n\t\tdispatch(setCategoryId(id));\r\n\t},[])\r\n\tconst onChangePage = (page:number) => {\r\n\t\tdispatch(setPageCount(page));\r\n\t};\r\n\tconst getPizzas = async () => {\r\n\t\tconst sortBy = sort.sortPropety.replace('-', '');\r\n\t\tconst order = sort.sortPropety.includes('-') ? 'asc' : 'desc';\r\n\t\tconst category = categoryId > 0 ? `&category_like=${categoryId}` : '';\r\n\t\tconst search = searchValue ? `&title_like=${searchValue}` : '';\r\n\r\n\t\tdispatch(\r\n\t\t\tfetchPizzas({\r\n\t\t\t\tsortBy,\r\n\t\t\t\torder,\r\n\t\t\t\tcategory,\r\n\t\t\t\tsearch,\r\n\t\t\t\tpageCount: String(pageCount),\r\n\t\t\t}),\r\n\t\t);\r\n\t};\r\n\r\n\tReact.useEffect(() => {\r\n\t\tgetPizzas();\r\n\t}, [categoryId, sort.sortPropety, searchValue, pageCount]);\r\n\r\n\t// React.useEffect(() => {\r\n\t// \tif (window.location.search) {\r\n\t// \t\tconst params = qs.parse(window.location.search.substring(1));\r\n\t// \t\tconst sort = sortList.find((obj) => obj.sortPropety === params.sortPropety);\r\n\t// \t\tdispatch(\r\n\t// \t\t\tsetFilters({\r\n\t// \t\t\t\t...params,\r\n\t// \t\t\t\tsort,\r\n\t// \t\t\t}),\r\n\t// \t\t);\r\n\t// \t\tisSearch.current = true;\r\n\t// \t}\r\n\t// }, []);\r\n\r\n\t// React.useEffect(() => {\r\n\t// \twindow.scrollTo(0, 0);\r\n\t// \tif(isSearch.current){\r\n\t// \t\tfetchPizzas()\r\n\t// \t}\r\n\t// \tisSearch.current = false;\r\n\r\n\t// }, [categoryId, sort.sortPropety, searchValue, pageCount]);\r\n\r\n\t// React.useEffect(() => {\r\n\t// if(isMounted.current){\r\n\t// \tconst queryString = qs.stringify({\r\n\t// \t\tsortPropety: sort.sortPropety,\r\n\t// \t\tcategoryId,\r\n\t// \t\tpageCount,\r\n\t// \t});\r\n\t// \tnavigate(`?${queryString}`);\r\n\t// }\r\n\t// isMounted.current = true\r\n\t// }, [categoryId, sort.sortPropety, pageCount]);\r\n\tconst pizzas = items.map((obj) => (\r\n\t\t\r\n\t\t\t<PizzaBlock key={obj.id} {...obj} />\r\n\t\r\n\t));\r\n\tconst skeletons = [...new Array(6)].map((_, index) => <Skeleton key={index} />);\r\n\treturn (\r\n\t\t<div className=\"container\">\r\n\t\t\t<div className=\"content__top\">\r\n\t\t\t\t<Categories value={categoryId} onClickCategory={onClickCategory} />\r\n\t\t\t\t<Sort value = {sort}/>\r\n\t\t\t</div>\r\n\t\t\t<h2 className=\"content__title\">–í—Å–µ –ø–∏—Ü—Ü—ã</h2>\r\n\t\t\t{status === 'error' ? (\r\n\t\t\t\t<div className=\"content__error-info\">\r\n\t\t\t\t\t<h2>\r\n\t\t\t\t\t\t–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ <span>üòï</span>\r\n\t\t\t\t\t</h2>\r\n\t\t\t\t\t<p>–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é,–Ω–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –ø–∏—Ç—Å—ã.–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–ø—ã—Ç–∫—É –ø–æ–∑–∂–µ.</p>\r\n\t\t\t\t</div>\r\n\t\t\t) : (\r\n\t\t\t\t<div className=\"content__items\">{status === 'loading' ? skeletons : pizzas}</div>\r\n\t\t\t)}\r\n\t\t\t<Pagination pageCount={pageCount} onChangePage={onChangePage} />\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Home;\r\n\r\n// import { useNavigate } from 'react-router-dom';\r\n// import qs from 'qs';\r\n\r\n// const navigate = useNavigate();\r\n// const isSearch = React.useRef(false);\r\n// const isMounted = React.useRef(false);\r\n\r\n// await axios\r\n// \t.get(\r\n// \t\t`http://localhost:3002/pizzas?_page=${pageCount}&_limit=4${category}&_sort=${sortBy}&_order=${order}${search}`,\r\n// \t)\r\n// \t.then((res) => {\r\n// \t\tsetItems(res.data);\r\n// \t});\r\n\r\n// {items.map((obj) => (\r\n// \t<PizzaBlock key={obj.id} {...obj} />\r\n// ))}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}